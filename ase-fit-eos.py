#!/usr/bin/python3.12
from ase.units import kJ
from ase.eos import EquationOfState
import numpy as np

#MÃ¡rcio Sampaio Gomes Filho @ 27/07/2024 17:05
#marcio.sampaio@ufabc.edu.br

#--------------------------------------------------------------------------------------------------------------------------
#       Fit equation of state for bulk systems 
#--------------------------------------------------------------------------------------------------------------------------
# eos = 'default'           --> a third order inverse polynomial fit
# eos = 'murnaghan'  
# eos = 'birch' 
# eos = 'birchmurnaghan'   
#
#  For order eos see: https://wiki.fysik.dtu.dk/ase/ase/eos.html#ase.eos.EquationOfState
#--------------------------------------------------------------------------------------------------------------------------

#--------------------------------------------------------------------------------------------------------------------------
#   Reading file: energy-v0.dat              format:        lattice, energies
#--------------------------------------------------------------------------------------------------------------------------
a, energies = np.loadtxt('energy.dat', unpack=True) 

#--------------------------------------------------------------------------------------------------------------------------
#   Equation of State (EOS)
#--------------------------------------------------------------------------------------------------------------------------
eos = EquationOfState(a, energies, eos='murnaghan')

#--------------------------------------------------------------------------------------------------------------------------
#   Fitting
#--------------------------------------------------------------------------------------------------------------------------
v0, e0, B = eos.fit()
#--------------------------------------------------------------------------------------------------------------------------
#   Print a0 and save figure - please note x-axis is in Ang
#--------------------------------------------------------------------------------------------------------------------------
print ("a0 = %.6f  Ang" % v0)
eos.plot('eos.png')
